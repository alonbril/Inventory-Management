{% extends "base.html" %}
{% block content %}
<div class="content">
    <h1>Loan Details</h1>

    <div class="loan-details-container">
        <div class="details-section">
            <h2>Loan Information</h2>
            <table class="details-table">
                <tr>
                    <th>Loan ID:</th>
                    <td>{{ loan['id'] }}</td>
                </tr>
                <tr>
                    <th>Green Number:</th>
                    <td>{{ loan['green_number'] }}</td>
                </tr>
                <tr>
                    <th>Item Name:</th>
                    <td>{{ loan['item_name'] }}</td>
                </tr>
                <tr>
                    <th>Borrower:</th>
                    <td>{{ loan['borrower_name'] }}</td>
                </tr>
                <tr>
                    <th>Loan Date:</th>
                    <td>{{ loan['loan_date'] }}</td>
                </tr>
                <tr>
                    <th>Status:</th>
                    <td>{{ loan['status'] }}</td>
                </tr>
                {% if loan['return_date'] %}
                <tr>
                    <th>Return Date:</th>
                    <td>{{ loan['return_date'] }}</td>
                </tr>
                {% endif %}
                {% if loan['status'] == 'active' %}
                <tr>
                    <th>Days Active:</th>
                    <td>{{ days_active }} days</td>
                </tr>
                {% endif %}
            </table>
        </div>

        {% if equipment %}
        <div class="equipment-section">
            <h2>Equipment Borrowed</h2>
            <table class="equipment-table">
                <thead>
                    <tr>
                        <th>Equipment Type</th>
                        <th>Quantity</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in equipment %}
                    <tr>
                        <td>{{ item['equipment_type'] }}</td>
                        <td>{{ item['quantity'] }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        {% if loan['signature'] %}
        <div class="signature-section">
            <h2>Signature</h2>
            <img src="{{ loan['signature'] }}" alt="Borrower's signature" class="signature-img">
        </div>
        {% endif %}
    </div>

    <div class="actions">
        <a href="{{ url_for('back_to_previous') }}" class="button back">Go Back</a>
        {% if loan['status'] == 'active' %}
            {% if days_active > 7 %}
            <a href="{{ url_for('extend_loan', id=loan['id']) }}"
               class="button edit"
               onclick="return confirm('Extend this loan for one more week?')">Extend</a>
            {% endif %}
            <a href="{{ url_for('return_loan', id=loan['id']) }}"
               class="button edit"
               onclick="return confirm('Mark this loan as returned?')">Return</a>
        {% endif %}
    </div>
</div>
{% endblock %}